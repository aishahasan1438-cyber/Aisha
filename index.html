<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© â€“ Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø³Ø§Ø¯Ø³ Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ - Ø¹Ø§Ø¦Ø´Ø© Ø­Ø³Ù† </title>
  <meta name="description" content="Ù…ÙˆÙ‚Ø¹ ØªÙØ§Ø¹Ù„ÙŠ Ù„Ù„ØªØ¯Ø±ÙŠØ¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ù„Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ." />

  <!-- ====== CSS (Ù…ÙØ¯Ù…Ø¬) ====== -->
  <style>
    :root {
      --bg: #0f172a; /* slate-900 */
      --card: #111827; /* gray-900 */
      --text: #e5e7eb; /* gray-200 */
      --muted: #94a3b8; /* slate-400 */
      --primary: #10b981; /* emerald-500 */
      --primary-700: #047857;
      --secondary: #60a5fa; /* blue-400 */
      --danger: #ef4444; /* red-500 */
      --chip: #1f2937; /* gray-800 */
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Naskh Arabic, Noto Sans Arabic, Arial, sans-serif;
      background: linear-gradient(120deg, #0b1023, #121a35);
      color: var(--text);
    }
    .app-header, .app-footer { padding: 1rem 1.2rem; background: rgba(0,0,0,0.25); backdrop-filter: blur(6px); }
    .app-header h1 { margin: 0 0 .5rem; font-size: 1.4rem; }
    .top-nav { display: flex; gap: .6rem; flex-wrap: wrap; }
    .linklike { background: var(--chip); color: var(--text); border: 1px solid #334155; padding: .5rem .8rem; border-radius: .6rem; cursor: pointer; }
    .linklike.danger { color: #fecaca; border-color: var(--danger); }
    .linklike:hover { filter: brightness(1.1); }

    .container { max-width: 900px; margin: 1rem auto; padding: 0 1rem; }
    .view { display: none; }
    .view.active { display: block; }

    .pill-list { display: flex; gap: .4rem; flex-wrap: wrap; list-style: none; padding: 0; }
    .pill-list li { background: var(--chip); padding: .4rem .7rem; border-radius: 999px; border: 1px solid #374151; }

    .start-form { margin-top: 1rem; background: rgba(17,24,39,.6); padding: 1rem; border: 1px solid #263043; border-radius: .8rem; }
    .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: .8rem; }
    label { display: grid; gap: .25rem; font-size: .95rem; }
    select, input[type="text"] { padding: .55rem .6rem; border-radius: .6rem; border: 1px solid #334155; background: #0b1222; color: var(--text); }
    .checkbox { display: flex; align-items: center; gap: .5rem; }
    .primary { background: var(--primary); color: #04251e; border: none; padding: .6rem 1rem; border-radius: .6rem; font-weight: 700; cursor: pointer; }
    .primary:hover { background: var(--primary-700); color: #e7fff7; }
    .secondary { background: var(--secondary); color: #0a1629; border: none; padding: .6rem 1rem; border-radius: .6rem; font-weight: 700; cursor: pointer; }
    .secondary[disabled] { opacity: .55; cursor: not-allowed; }
    .badge { background: #0b1222; border: 1px solid #2a3653; padding: .35rem .6rem; border-radius: .5rem; }
    .muted { color: var(--muted); }

    .practice-head { display: flex; align-items: center; justify-content: space-between; gap: .6rem; }
    .card { background: rgba(17,24,39,.6); border: 1px solid #263043; border-radius: .8rem; padding: 1rem; margin-top: 1rem; }
    .q-text { font-size: 1.25rem; margin-bottom: .6rem; }
    .q-choices { display: grid; gap: .5rem; margin-bottom: .6rem; }
    .choice { display: block; text-align: start; background: #101827; border: 1px solid #2a3653; padding: .55rem .7rem; border-radius: .6rem; cursor: pointer; }
    .choice:hover { border-color: #4f46e5; }
    .choice.selected { outline: 2px solid #4f46e5; }

    .free-input { width: 100%; margin-inline-start: .4rem; max-width: 280px; }
    .actions { display: flex; gap: .5rem; align-items: center; flex-wrap: wrap; }

    .feedback { margin-top: .6rem; font-weight: 700; }
    .feedback.ok { color: #86efac; }
    .feedback.no { color: #fecaca; }
    .hint { margin-top: .4rem; }

    @media (max-width: 480px) {
      .app-header h1 { font-size: 1.1rem; }
    }
  </style>
</head>

<body>
  <header class="app-header">
    <h1>ğŸš€ ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© â€“ Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø³Ø§Ø¯Ø³</h1>
    <nav class="top-nav" aria-label="Ø§Ù„ØªÙ†Ù‚Ù„">
      <button id="btn-home" class="linklike" aria-controls="home">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
      <button id="btn-practice" class="linklike" aria-controls="practice">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¯Ø±ÙŠØ¨</button>
      <button id="btn-report" class="linklike" aria-controls="report">Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
      <button id="btn-reset" class="linklike danger" title="Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙ‚Ø¯Ù…">ØªØµÙÙŠØ± Ø§Ù„ØªÙ‚Ø¯Ù…</button>
    </nav>
  </header>

  <main id="main" class="container">
    <!-- ØµÙØ­Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
    <section id="home" class="view active" aria-labelledby="home-title">
      <h2 id="home-title">Ù…Ø±Ø­Ø¨Ù‹Ø§ ğŸ‘‹</h2>
      <p>
        Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ³Ø§Ø¹Ø¯Ùƒ Ø¹Ù„Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© <strong>Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª</strong> Ù„Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ Ù…Ù† Ø®Ù„Ø§Ù„ Ø£Ø³Ø¦Ù„Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù…Ø¹ ØªØºØ°ÙŠØ© Ø±Ø§Ø¬Ø¹Ø© ÙÙˆØ±ÙŠØ©.
      </p>
      <ol class="pill-list">
        <li>Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø£Ø±Ø¨Ø¹</li>
        <li>Ø§Ù„ÙƒØ³ÙˆØ± ÙˆØ§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¹Ø´Ø±ÙŠØ© ÙˆØ§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</li>
        <li>Ø§Ù„Ù†Ø³Ø¨Ø© ÙˆØ§Ù„ØªÙ†Ø§Ø³Ø¨</li>
        <li>Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© ÙˆÙ‚ÙŠØ§Ø³ Ø§Ù„Ø²ÙˆØ§ÙŠØ§ ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø© ÙˆØ§Ù„Ø­Ø¬Ù…</li>
        <li>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø§Ø­ØªÙ…Ø§Ù„</li>
        <li>Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„ØªØ¹Ø§Ø¨ÙŠØ± ÙˆØ§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø©</li>
      </ol>
      <p class="muted">Ø§Ø®ØªØ± ÙˆØ¶Ø¹ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø¨Ø§Ù„Ø£Ø³ÙÙ„ Ø«Ù… Ø§Ø¶ØºØ· Â«Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†Â».</p>

      <form id="start-form" class="start-form" aria-label="Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¨Ø¯Ø¡">
        <div class="grid-2">
          <label>
            Ø§Ù„Ù…Ø¬Ø§Ù„
            <select id="domain-select" name="domain">
              <option value="all">ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª</option>
              <option value="operations">Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</option>
              <option value="fractions">Ø§Ù„ÙƒØ³ÙˆØ± ÙˆØ§Ù„Ø¹Ø´Ø±ÙŠ</option>
              <option value="ratio">Ø§Ù„Ù†Ø³Ø¨Ø© ÙˆØ§Ù„ØªÙ†Ø§Ø³Ø¨</option>
              <option value="geometry">Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© ÙˆØ§Ù„Ù‚ÙŠØ§Ø³</option>
              <option value="data">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø§Ø­ØªÙ…Ø§Ù„</option>
              <option value="algebra">Ø§Ù„ØªØ¹Ø§Ø¨ÙŠØ± ÙˆØ§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª</option>
            </select>
          </label>
          <label>
            Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
            <select id="count-select" name="count">
              <option>5</option>
              <option selected>10</option>
              <option>15</option>
              <option>20</option>
            </select>
          </label>
          <label>
            Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©
            <select id="level-select" name="level">
              <option value="mix" selected>Ù…ØªÙ†ÙˆØ¹</option>
              <option value="1">Ø³Ù‡Ù„</option>
              <option value="2">Ù…ØªÙˆØ³Ø·</option>
              <option value="3">Ù…ØªÙ‚Ø¯Ù…</option>
            </select>
          </label>
          <label class="checkbox">
            <input type="checkbox" id="timed-mode" /> ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Øª (30 Ø«Ø§Ù†ÙŠØ© Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„)
          </label>
        </div>
        <button type="submit" class="primary">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button>
      </form>
    </section>

    <!-- ØµÙØ­Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ -->
    <section id="practice" class="view" aria-labelledby="practice-title">
      <div class="practice-head">
        <h2 id="practice-title">Ø§Ù„ØªØ¯Ø±ÙŠØ¨</h2>
        <div class="stats">
          <span id="progress-badge" class="badge" aria-live="polite">0/0</span>
          <span id="timer" class="badge" hidden>â± 30</span>
          <span id="score" class="badge">Ø§Ù„Ø¯Ø±Ø¬Ø©: 0</span>
        </div>
      </div>

      <div id="q-card" class="card" aria-live="polite">
        <div id="q-text" class="q-text"></div>
        <div id="q-choices" class="q-choices"></div>
        <div class="actions">
          <input id="free-input" class="free-input" type="text" inputmode="decimal" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©" aria-label="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©" />
          <button id="btn-check" class="primary">ØªØ­Ù‚Ù‚</button>
          <button id="btn-next" class="secondary" disabled>Ø§Ù„ØªØ§Ù„ÙŠ â–¶</button>
        </div>
        <div id="feedback" class="feedback" aria-live="polite"></div>
        <details id="hint-box" class="hint"><summary>ØªÙ„Ù…ÙŠØ­</summary><div id="hint-text"></div></details>
      </div>
    </section>

    <!-- ØµÙØ­Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± -->
    <section id="report" class="view" aria-labelledby="report-title">
      <h2 id="report-title">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡</h2>
      <div id="report-content" class="card">
        <p class="muted">Ø§Ø¨Ø¯Ø£ ØªØ¯Ø±ÙŠØ¨Ù‹Ø§ Ù„Ø¹Ø±Ø¶ ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„ Ø¹Ù† Ø§Ù„Ø¯Ø±Ø¬Ø§Øª ÙˆØ§Ù„Ø²Ù…Ù† ÙˆÙ†ÙÙ‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„Ø§Ø­ØªÙŠØ§Ø¬.</p>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <small>Â© 2026 â€” Ù…ÙˆÙ‚Ø¹ ØªØ¯Ø±ÙŠØ¨ÙŠ Ù…Ø¬Ø§Ù†ÙŠ Ù„Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†. ÙŠØ¹Ù…Ù„ Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„.</small>
  </footer>

  <!-- ====== JavaScript (Ù…ÙØ¯Ù…Ø¬) ====== -->
  <script>
    // ===== Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (Ù…Ø¯Ù…Ø¬ Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø©) =====
    const QUESTIONS = [
      {"id":1,"domain":"operations","level":1,"type":"mcq","text":"Ù†Ø§ØªØ¬ 48 Ã· 6 =","choices":["6","7","8","9"],"answer":"8","hint":"Ø§Ù„Ù‚Ø³Ù…Ø© Ù…Ø¹ÙƒÙˆØ³Ø© Ù„Ù„Ø¶Ø±Ø¨: 6 Ã— 8 = 48"},
      {"id":2,"domain":"operations","level":1,"type":"mcq","text":"Ù†Ø§ØªØ¬ 35 + 27 =","choices":["52","60","62","64"],"answer":"62","hint":"Ø§Ø¬Ù…Ø¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø«Ù… Ø§Ù„Ø¹Ø´Ø±Ø§Øª."},
      {"id":3,"domain":"operations","level":2,"type":"input","text":"Ø§Ø­Ø³Ø¨: 125 âˆ’ 87","answer":"38","hint":"Ø§Ø³ØªÙ„Ù Ù…Ù† Ø§Ù„Ø¹Ø´Ø±Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©."},
      {"id":4,"domain":"operations","level":2,"type":"mcq","text":"Ù†Ø§ØªØ¬ 14 Ã— 6 =","choices":["64","74","84","96"],"answer":"84","hint":"6 Ã— 10 + 6 Ã— 4"},
      {"id":5,"domain":"operations","level":3,"type":"input","text":"Ù†Ø§ØªØ¬ 420 Ã· 15","answer":"28","hint":"Ù‚Ø³Ù‘Ù… ÙƒÙ„Ø§Ù‡Ù…Ø§ Ø¹Ù„Ù‰ 5 Ø£ÙˆÙ„Ø§Ù‹."},
      {"id":6,"domain":"operations","level":3,"type":"input","text":"Ø§Ø­Ø³Ø¨ 3(12 âˆ’ 5)","answer":"21","hint":"Ø·Ø¨Ù‘Ù‚ Ø£Ø³Ø¨Ù‚ÙŠØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª (Ø§Ù„Ø£Ù‚ÙˆØ§Ø³ Ø«Ù… Ø§Ù„Ø¶Ø±Ø¨)."},

      {"id":10,"domain":"fractions","level":1,"type":"mcq","text":"Ø£ÙŠ Ø§Ù„ÙƒØ³ÙˆØ± ÙŠÙƒØ§ÙØ¦ 1/2ØŸ","choices":["2/3","3/4","4/8","3/6"],"answer":"4/8","hint":"Ø§Ø¶Ø±Ø¨ Ø§Ù„Ø¨Ø³Ø· ÙˆØ§Ù„Ù…Ù‚Ø§Ù… ÙÙŠ Ø§Ù„Ø¹Ø¯Ø¯ Ù†ÙØ³Ù‡."},
      {"id":11,"domain":"fractions","level":1,"type":"input","text":"Ø­ÙˆÙ‘Ù„ 0.25 Ø¥Ù„Ù‰ ÙƒØ³Ø± Ù…Ø¨Ø³Ø·","answer":"1/4","hint":"0.25 = 25/100 Ø«Ù… Ø¨Ø³Ø·."},
      {"id":12,"domain":"fractions","level":2,"type":"input","text":"Ø§Ø­Ø³Ø¨: 3/5 + 2/5","answer":"1","hint":"Ø§Ù„Ù…Ù‚Ø§Ù…Ø§Øª Ù…ØªØ³Ø§ÙˆÙŠØ©: Ø§Ø¬Ù…Ø¹ Ø§Ù„Ø¨Ø³ÙˆØ· ÙÙ‚Ø·."},
      {"id":13,"domain":"fractions","level":2,"type":"mcq","text":"Ø§Ø­Ø³Ø¨: 7/8 âˆ’ 1/4","choices":["3/8","5/8","1/2","7/12"],"answer":"5/8","hint":"ÙˆØ­Ù‘Ø¯ Ø§Ù„Ù…Ù‚Ø§Ù…Ø§Øª Ø«Ù… Ø§Ø·Ø±Ø­."},
      {"id":14,"domain":"fractions","level":3,"type":"input","text":"Ù†Ø§ØªØ¬ 2/3 Ã— 9","answer":"6","hint":"Ø§Ø¶Ø±Ø¨ Ø«Ù… Ø¨Ø³Ù‘Ø·: 9 Ã— 2/3 = 18/3"},
      {"id":15,"domain":"fractions","level":3,"type":"input","text":"Ø­ÙˆÙ‘Ù„ 45% Ø¥Ù„Ù‰ Ø¹Ø¯Ø¯ Ø¹Ø´Ø±ÙŠ","answer":"0.45","hint":"Ø§Ù‚Ø³Ù… Ø¹Ù„Ù‰ 100."},

      {"id":20,"domain":"ratio","level":1,"type":"mcq","text":"Ø§Ù„Ù†Ø³Ø¨Ø© Ø¨ÙŠÙ† 2 Ø·Ù„Ø§Ø¨ Ùˆ 8 Ø·Ø§Ù„Ø¨Ø§Øª Ù‡ÙŠ","choices":["1:4","1:3","2:8","4:1"],"answer":"1:4","hint":"Ù‚Ø³Ù‘Ù… Ø§Ù„Ø·Ø±ÙÙŠÙ† Ø¹Ù„Ù‰ 2."},
      {"id":21,"domain":"ratio","level":2,"type":"input","text":"Ø¥Ø°Ø§ 3 Ø£Ù‚Ù„Ø§Ù… ØªÙƒÙ„Ù 9 Ø±ÙŠØ§Ù„Ø§ØªØŒ ÙÙƒÙ… Ø«Ù…Ù† 5 Ø£Ù‚Ù„Ø§Ù…ØŸ","answer":"15","hint":"Ø§Ø¹ØªÙ…Ø¯ Ø§Ù„ØªÙ†Ø§Ø³Ø¨ Ø§Ù„Ø·Ø±Ø¯ÙŠ (Ã—5/3)."},
      {"id":22,"domain":"ratio","level":3,"type":"input","text":"Ø¯Ø±Ø¬Ø© Ø§Ø®ØªØ¨Ø§Ø± 40 Ù…Ù† 50. Ù…Ø§ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©ØŸ","answer":"80","hint":"(40/50)Ã—100"},

      {"id":30,"domain":"geometry","level":1,"type":"mcq","text":"ÙƒÙ… Ø¯Ø±Ø¬Ø© Ù‚ÙŠØ§Ø³ Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©ØŸ","choices":["45Â°","60Â°","90Â°","180Â°"],"answer":"90Â°","hint":"Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ØªØ´ÙƒÙ„ Ø­Ø±Ù L."},
      {"id":31,"domain":"geometry","level":1,"type":"input","text":"Ù…Ø­ÙŠØ· Ù…Ø³ØªØ·ÙŠÙ„ Ø·ÙˆÙ„Ù‡ 8 Ø³Ù… ÙˆØ¹Ø±Ø¶Ù‡ 3 Ø³Ù…","answer":"22","hint":"Ù…Ø­ÙŠØ· = 2(Ø§Ù„Ø·ÙˆÙ„+Ø§Ù„Ø¹Ø±Ø¶)."},
      {"id":32,"domain":"geometry","level":2,"type":"input","text":"Ù…Ø³Ø§Ø­Ø© Ù…Ø«Ù„Ø« Ù‚Ø§Ø¹Ø¯ØªÙ‡ 10 Ø³Ù… ÙˆØ§Ø±ØªÙØ§Ø¹Ù‡ 6 Ø³Ù…","answer":"30","hint":"(Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©Ã—Ø§Ù„Ø§Ø±ØªÙØ§Ø¹)/2"},
      {"id":33,"domain":"geometry","level":2,"type":"mcq","text":"ÙƒÙ… Ø¶Ù„Ø¹Ù‹Ø§ Ù„Ù„Ù…Ø¶Ù„Ø¹ Ø§Ù„Ø³Ø¯Ø§Ø³ÙŠØŸ","choices":["4","5","6","8"],"answer":"6","hint":"Ø³Ø¯Ø§Ø³ÙŠ = Ø³ØªØ©."},
      {"id":34,"domain":"geometry","level":3,"type":"input","text":"Ø­Ø¬Ù… Ù…ØªÙˆØ§Ø²ÙŠ Ù…Ø³ØªØ·ÙŠÙ„Ø§Øª 4Ã—3Ã—5 Ø³Ù…Â³","answer":"60","hint":"Ø§Ù„Ø·ÙˆÙ„Ã—Ø§Ù„Ø¹Ø±Ø¶Ã—Ø§Ù„Ø§Ø±ØªÙØ§Ø¹."},

      {"id":40,"domain":"data","level":1,"type":"mcq","text":"Ù…Ø§ Ø§Ù„Ù…ÙˆØ¶Ø© (Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙƒØ«Ø± ØªÙƒØ±Ø§Ø±Ù‹Ø§) Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©: 3, 5, 5, 2, 5, 4","choices":["3","4","5","Ù„Ø§ ÙŠÙˆØ¬Ø¯"],"answer":"5","hint":"Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙƒØ«Ø± ØªÙƒØ±Ø§Ø±Ù‹Ø§."},
      {"id":41,"domain":"data","level":2,"type":"input","text":"Ø§Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠ Ù„Ù€ 2,4,6,8","answer":"5","hint":"Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù‚ÙŠÙ… Ã· Ø¹Ø¯Ø¯Ù‡Ø§."},
      {"id":42,"domain":"data","level":3,"type":"mcq","text":"ÙØ±ØµØ© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø²ÙˆØ¬ÙŠ Ø¹Ù†Ø¯ Ø±Ù…ÙŠ Ù…ÙƒØ¹Ø¨ Ø£Ø±Ù‚Ø§Ù… Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©","choices":["1/6","1/3","1/2","2/3"],"answer":"1/2","hint":"Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø²ÙˆØ¬ÙŠØ©: 2,4,6."},

      {"id":50,"domain":"algebra","level":1,"type":"mcq","text":"Ù‚ÙŠÙ…Ø© x ÙÙŠ 12 = x + 5","choices":["5","6","7","8"],"answer":"7","hint":"Ø§Ù†Ù‚Ù„ 5 Ù„Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø± Ø¨Ø§Ù„Ø·Ø±Ø­."},
      {"id":51,"domain":"algebra","level":2,"type":"input","text":"Ø¨Ø³Ù‘Ø·: 3x + 2x","answer":"5x","hint":"Ø§Ø¬Ù…Ø¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…ØªØ´Ø§Ø¨Ù‡Ø©."},
      {"id":52,"domain":"algebra","level":3,"type":"input","text":"Ø¥Ø°Ø§ 2y = 18ØŒ ÙØ¥Ù† y =","answer":"9","hint":"Ø§Ù‚Ø³Ù… Ø§Ù„Ø·Ø±ÙÙŠÙ† Ø¹Ù„Ù‰ 2."},

      {"id":60,"domain":"operations","level":1,"type":"mcq","text":"Ù†Ø§ØªØ¬ 90 âˆ’ 27 =","choices":["53","63","73","77"],"answer":"63","hint":"Ø§Ø·Ø±Ø­ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø«Ù… Ø§Ù„Ø¹Ø´Ø±Ø§Øª."},
      {"id":61,"domain":"operations","level":2,"type":"input","text":"Ø§Ø­Ø³Ø¨: 18 Ã— 7","answer":"126","hint":"Ø§Ø³ØªØ®Ø¯Ù… 20Ã—7 Ø«Ù… Ø§Ø·Ø±Ø­ 2Ã—7."},
      {"id":62,"domain":"fractions","level":2,"type":"mcq","text":"Ø£ÙŠÙ‡Ø§ Ø£ÙƒØ¨Ø±ØŸ 3/4 Ø£Ù… 2/3","choices":["3/4","2/3","Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†"],"answer":"3/4","hint":"ÙˆØ­Ù‘Ø¯ Ø§Ù„Ù…Ù‚Ø§Ù…Ø§Øª Ø¥Ù„Ù‰ 12."},
      {"id":63,"domain":"fractions","level":3,"type":"input","text":"Ø§ÙƒØªØ¨ 0.6 Ø¹Ù„Ù‰ ØµÙˆØ±Ø© ÙƒØ³Ø± Ù…Ø¨Ø³Ø·","answer":"3/5","hint":"6/10 Ø«Ù… Ø¨Ø³Ø·."},
      {"id":64,"domain":"ratio","level":1,"type":"mcq","text":"Ø§Ù„Ù…Ø¹Ø¯Ù„ Ù„Ø³Ø±Ø¹Ø© 120 ÙƒÙ… ÙÙŠ 3 Ø³Ø§Ø¹Ø§Øª =","choices":["30 ÙƒÙ…/Ø³Ø§","40 ÙƒÙ…/Ø³Ø§","50 ÙƒÙ…/Ø³Ø§","60 ÙƒÙ…/Ø³Ø§"],"answer":"40 ÙƒÙ…/Ø³Ø§","hint":"Ø§Ù„Ù‚Ø³Ù…Ø© Ø¹Ù„Ù‰ 3."},
      {"id":65,"domain":"geometry","level":1,"type":"mcq","text":"Ù…Ø¬Ù…ÙˆØ¹ Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø«Ù„Ø« =","choices":["90Â°","120Â°","180Â°","360Â°"],"answer":"180Â°","hint":"Ø«Ø§Ø¨Øª ÙÙŠ ÙƒÙ„ Ø§Ù„Ù…Ø«Ù„Ø«Ø§Øª."},
      {"id":66,"domain":"geometry","level":2,"type":"input","text":"Ù†ØµÙ Ù‚Ø·Ø± Ø¯Ø§Ø¦Ø±Ø© Ù‚Ø·Ø±Ù‡Ø§ 14 Ø³Ù… =","answer":"7","hint":"Ù†ØµÙ Ø§Ù„Ù‚Ø·Ø± = Ø§Ù„Ù‚Ø·Ø± Ã· 2."},
      {"id":67,"domain":"data","level":1,"type":"input","text":"Ø§Ù„Ù…Ø¯Ù‰ Ù„Ù„Ù‚ÙŠÙ… 2,4,7,10","answer":"8","hint":"Ø£ÙƒØ¨Ø± Ù‚ÙŠÙ…Ø© âˆ’ Ø£ØµØºØ± Ù‚ÙŠÙ…Ø©."},
      {"id":68,"domain":"algebra","level":2,"type":"mcq","text":"Ù‚ÙŠÙ…Ø© 2x Ø¹Ù†Ø¯Ù…Ø§ x=5","choices":["5","7","10","12"],"answer":"10","hint":"Ø¹ÙˆÙ‘ÙØ¶ Ø¨Ù‚ÙŠÙ…Ø© x Ù…Ø¨Ø§Ø´Ø±Ø©."},
      {"id":69,"domain":"operations","level":1,"type":"input","text":"Ø§ÙƒÙ…Ù„: 9 Ã— 9 =","answer":"81","hint":"Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ³Ø¹Ø©."},
      {"id":70,"domain":"fractions","level":3,"type":"mcq","text":"%25 Ù…Ù† 60 =","choices":["10","12","15","20"],"answer":"15","hint":"Ø±Ø¨Ø¹ Ø§Ù„Ø¹Ø¯Ø¯."},
      {"id":71,"domain":"ratio","level":2,"type":"input","text":"Ø¥Ø°Ø§ 5 ÙƒØ¹ÙƒØ§Øª ØªÙƒÙ„Ù 25 Ø±ÙŠØ§Ù„Ù‹Ø§ØŒ ÙÙ…Ø§ Ø«Ù…Ù† 1 ÙƒØ¹ÙƒØ©ØŸ","answer":"5","hint":"Ù‚Ø³Ù…Ø© ÙƒÙ„ÙŠØ© Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø·Ø¹."},
      {"id":72,"domain":"algebra","level":3,"type":"input","text":"Ø­Ù„: x/4 = 3","answer":"12","hint":"Ø§Ø¶Ø±Ø¨ Ø§Ù„Ø·Ø±ÙÙŠÙ† ÙÙŠ 4."},
      {"id":73,"domain":"data","level":2,"type":"mcq","text":"Ø§Ø­ØªÙ…Ø§Ù„ Ø¸Ù‡ÙˆØ± ÙˆØ¬Ù‡Ø© (ØµÙˆØ±Ø©) ÙÙŠ Ø±Ù…ÙŠØ© Ø¹Ù…Ù„Ø© Ø¹Ø§Ø¯Ù„Ø©","choices":["0","1/4","1/2","1"],"answer":"1/2","hint":"ÙˆØ¬Ù‡ Ø£Ùˆ ÙƒØªØ§Ø¨Ø© Ø§Ø­ØªÙ…Ø§Ù„Ù‡Ù…Ø§ Ù…ØªØ³Ø§ÙˆÙ."},
      {"id":74,"domain":"geometry","level":3,"type":"input","text":"Ù…Ø³Ø§Ø­Ø© Ù…Ø³ØªØ·ÙŠÙ„ 12Ã—5 Ø³Ù…Â²","answer":"60","hint":"Ø§Ù„Ø·ÙˆÙ„ Ã— Ø§Ù„Ø¹Ø±Ø¶."}
    ];

    // ===== Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ =====
    const state = { all: [], session: [], currentIndex: 0, score: 0, timed: false, timeLeft: 30, timerId: null, report: [] };

    // ===== Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© =====
    const views = { home: document.getElementById('home'), practice: document.getElementById('practice'), report: document.getElementById('report') };
    const nav = { home: document.getElementById('btn-home'), practice: document.getElementById('btn-practice'), report: document.getElementById('btn-report'), reset: document.getElementById('btn-reset') };
    const qText = document.getElementById('q-text');
    const qChoices = document.getElementById('q-choices');
    const freeInput = document.getElementById('free-input');
    const btnCheck = document.getElementById('btn-check');
    const btnNext = document.getElementById('btn-next');
    const feedback = document.getElementById('feedback');
    const hintBox = document.getElementById('hint-box');
    const hintText = document.getElementById('hint-text');
    const progressBadge = document.getElementById('progress-badge');
    const timerBadge = document.getElementById('timer');
    const scoreBadge = document.getElementById('score');
    const reportContent = document.getElementById('report-content');

    const labels = {
      operations: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª',
      fractions: 'Ø§Ù„ÙƒØ³ÙˆØ± ÙˆØ§Ù„Ø¹Ø´Ø±ÙŠ',
      ratio: 'Ø§Ù„Ù†Ø³Ø¨Ø© ÙˆØ§Ù„ØªÙ†Ø§Ø³Ø¨',
      geometry: 'Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© ÙˆØ§Ù„Ù‚ÙŠØ§Ø³',
      data: 'Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø§Ø­ØªÙ…Ø§Ù„',
      algebra: 'Ø§Ù„ØªØ¹Ø§Ø¨ÙŠØ± ÙˆØ§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª'
    };

    // ===== ØªÙ†Ù‚Ù„ =====
    function goto(viewId){
      document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
      views[viewId].classList.add('active');
    }
    nav.home.addEventListener('click', ()=>goto('home'));
    nav.practice.addEventListener('click', ()=>goto('practice'));
    nav.report.addEventListener('click', ()=>goto('report'));
    nav.reset.addEventListener('click', ()=>{
      if(confirm('Ø³ÙŠØªÙ… Ø­Ø°Ù ØªÙ‚Ø¯Ù…Ùƒ Ø§Ù„Ù…Ø­Ù„ÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ')){
        localStorage.removeItem('math6_report');
        alert('ØªÙ… ØªØµÙÙŠØ± Ø§Ù„ØªÙ‚Ø¯Ù….');
        location.reload();
      }
    });

    // ===== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (Ù…Ù† Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©) =====
    function loadQuestions(){
      state.all = QUESTIONS.slice(); // Ù†Ø³Ø®Ø©
    }

    // ===== Ø§Ø®ØªÙŠØ§Ø± Ø¹ÙŠÙ†Ø© =====
    function sampleQuestions({domain='all', level='mix', count=10}){
      let filtered = state.all.filter(q => (domain==='all' || q.domain===domain) && (level==='mix' || q.level===+level));
      if(filtered.length < count){
        const more = state.all.filter(q => (domain==='all' || q.domain===domain));
        filtered = filtered.concat(more);
      }
      for(let i=filtered.length-1;i>0;i--){
        const j = Math.floor(Math.random()* (i+1));
        [filtered[i], filtered[j]] = [filtered[j], filtered[i]];
      }
      return filtered.slice(0, count);
    }

    // ===== Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„ =====
    function renderQuestion(){
      const q = state.session[state.currentIndex];
      if(!q){ return; }

      progressBadge.textContent = `${state.currentIndex+1}/${state.session.length}`;
      scoreBadge.textContent = `Ø§Ù„Ø¯Ø±Ø¬Ø©: ${state.score}`;

      qText.textContent = q.text;
      feedback.textContent = '';
      feedback.className = 'feedback';
      hintText.textContent = q.hint || '';
      hintBox.open = false;

      qChoices.innerHTML = '';
      freeInput.value = '';
      freeInput.style.display = 'none';

      if(q.type === 'mcq'){
        q.choices.forEach((c)=>{
          const b = document.createElement('button');
          b.className = 'choice';
          b.textContent = c;
          b.addEventListener('click', ()=>{
            document.querySelectorAll('.choice').forEach(x=>x.classList.remove('selected'));
            b.classList.add('selected');
            b.dataset.selected = 'true';
          });
          qChoices.appendChild(b);
        });
      } else if(q.type === 'input'){
        freeInput.style.display = 'inline-block';
        freeInput.focus();
      }

      btnNext.disabled = true;
      if(state.timed){ startTimer(); } else { stopTimer(); }
    }

    // ===== Ø£Ø¯ÙˆØ§Øª =====
    function norm(x){ return String(x).trim().replace(/\s+/g,''); }

    function checkAnswer(){
      const q = state.session[state.currentIndex];
      let userAns = null;

      if(q.type==='mcq'){
        const sel = document.querySelector('.choice.selected');
        if(!sel){ alert('Ø§Ø®ØªØ± Ø¥Ø¬Ø§Ø¨Ø©.'); return; }
        userAns = sel.textContent;
      } else {
        userAns = freeInput.value;
        if(userAns.trim()===''){ alert('Ø£Ø¯Ø®Ù„ Ø¥Ø¬Ø§Ø¨Ø©.'); return; }
      }

      let correct = false;
      if(q.type==='mcq'){
        correct = norm(userAns) === norm(q.answer);
      } else {
        const ua = Number(userAns.replace(',', '.'));
        const an = Number(String(q.answer).replace(',', '.'));
        if(!Number.isNaN(ua) && !Number.isNaN(an)){
          correct = Math.abs(ua - an) < 1e-6;
        } else {
          correct = norm(userAns) === norm(q.answer);
        }
      }

      if(correct){
        state.score += 1;
        feedback.textContent = 'Ø£Ø­Ø³Ù†Øª! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© âœ…';
        feedback.classList.add('ok');
      } else {
        feedback.innerHTML = `Ø¥Ø¬Ø§Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø© âŒ â€” Ø§Ù„ØµØ­ÙŠØ­: <strong>${q.answer}</strong>`;
        feedback.classList.add('no');
      }

      const entry = {
        text: q.text,
        domain: q.domain,
        level: q.level,
        user: userAns,
        answer: q.answer,
        correct,
        time: state.timed ? (30 - state.timeLeft) : null
      };
      state.report.push(entry);

      stopTimer();
      btnNext.disabled = false;
    }

    function nextQuestion(){
      state.currentIndex += 1;
      if(state.currentIndex >= state.session.length){
        endSession();
      } else {
        renderQuestion();
      }
    }

    function startTimer(){
      state.timeLeft = 30;
      timerBadge.hidden = false;
      timerBadge.textContent = `â± ${state.timeLeft}`;
      stopTimer(); // Ø£ÙˆÙ‚Ù Ø£ÙŠ Ù…Ø¤Ù‚Øª Ù‚Ø¯ÙŠÙ…
      state.timerId = setInterval(()=>{
        state.timeLeft -= 1;
        timerBadge.textContent = `â± ${state.timeLeft}`;
        if(state.timeLeft <= 0){
          stopTimer();
          feedback.textContent = 'Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª â±';
          btnNext.disabled = false;
        }
      }, 1000);
    }

    function stopTimer(){
      if(state.timerId){ clearInterval(state.timerId); state.timerId=null; }
      if(!state.timed){ timerBadge.hidden = true; }
    }

    function endSession(){
      const prev = JSON.parse(localStorage.getItem('math6_report')||'[]');
      prev.push({
        date: new Date().toISOString(),
        total: state.session.length,
        score: state.score,
        percent: Math.round(100*state.score/state.session.length),
        details: state.report
      });
      localStorage.setItem('math6_report', JSON.stringify(prev));

      showReport(prev[prev.length-1]);
      goto('report');
    }

    function showReport(session){
      const byDomain = {};
      session.details.forEach(d=>{
        byDomain[d.domain] = byDomain[d.domain] || {correct:0,total:0};
        byDomain[d.domain].total += 1;
        if(d.correct) byDomain[d.domain].correct += 1;
      });
      const items = Object.entries(byDomain).map(([k,v])=>{
        const p = Math.round(100*v.correct/v.total);
        return `<li><strong>${labels[k]||k}</strong>: ${v.correct}/${v.total} (${p}%)</li>`;
      }).join('');

      const rows = session.details.map((d,i)=>{
        const emoji = d.correct ? 'âœ…' : 'âŒ';
        const t = d.time!=null? `${d.time}s` : '-';
        return `<tr>
          <td>${i+1}</td>
          <td>${labels[d.domain]||d.domain}</td>
          <td>${d.text}</td>
          <td>${d.user}</td>
          <td>${d.answer}</td>
          <td style="text-align:center">${emoji}</td>
          <td style="text-align:center">${t}</td>
        </tr>`;
      }).join('');

      reportContent.innerHTML = `
        <h3>Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¬Ù„Ø³Ø©: ${session.score}/${session.total} (${session.percent}%)</h3>
        <p class="muted">ØªØ§Ø±ÙŠØ®: ${new Date(session.date).toLocaleString('ar')}</p>
        <h4>Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª</h4>
        <ul>${items}</ul>
        <details><summary>ØªÙØ§ØµÙŠÙ„ ÙƒÙ„ Ø³Ø¤Ø§Ù„</summary>
          <div style="overflow:auto">
            <table style="width:100%; border-collapse:collapse">
              <thead>
                <tr>
                  <th>#</th><th>Ø§Ù„Ù…Ø¬Ø§Ù„</th><th>Ø§Ù„Ø³Ø¤Ø§Ù„</th><th>Ø¥Ø¬Ø§Ø¨ØªÙƒ</th><th>Ø§Ù„ØµØ­ÙŠØ­</th><th>ØµØ­Ø©</th><th>Ø§Ù„Ø²Ù…Ù†</th>
                </tr>
              </thead>
              <tbody>${rows}</tbody>
            </table>
          </div>
        </details>
      `;
    }

    // ===== Ø¨Ø¯Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø© =====
    const startForm = document.getElementById('start-form');
    startForm.addEventListener('submit', (e)=>{
      e.preventDefault();
      const domain = document.getElementById('domain-select').value;
      const count = +document.getElementById('count-select').value;
      const level = document.getElementById('level-select').value;
      const timed = document.getElementById('timed-mode').checked;

      state.session = sampleQuestions({domain, level, count});
      state.currentIndex = 0;
      state.score = 0;
      state.report = [];
      state.timed = timed;

      goto('practice');
      renderQuestion();
    });

    // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­Ù‚Ù‚/Ø§Ù„ØªØ§Ù„ÙŠ
    btnCheck.addEventListener('click', checkAnswer);
    btnNext.addEventListener('click', nextQuestion);

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø¨Ø¯Ø¡
    loadQuestions();
  </script>
</body>

</html>
